<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ricevute</title>
    <link rel="shortcut icon" type="image/x-icon" href="Images/favicon.ico">
    <link rel="stylesheet" href="https://kit-free.fontawesome.com/releases/latest/css/free.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="Styles/site.css">

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"
        integrity="sha256-eGE6blurk5sHj+rmkfsGYeKyZx3M4bG+ZlFyA7Kns7E=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script>

</head>

<body>
    <div class="container mt-4">
        <h1>Genera Ricevute</h1>
        <hr>
        <div class="row">
            <div class="col-md-12 mt-2">
                <div>
                    <h4> <a data-toggle="collapse" href="#SignatureContainer" id="SignatureCollapser" class="text-dark"
                            aria-expanded="false">Firma
                            <span class="text-collapsed"><i class="fas fa-chevron-down"></i></span>
                            <span class="text-expanded"><i class="fas fa-chevron-up"></i></span>
                        </a></h4>
                    <div id="SignatureContainer" class="collapse">
                        <p>Le ricevute devono essere firmate, qua sotto hai la possibilità di firmare (o di <a href="#"
                                onclick="ImportSignature()">importarne una esistente</a>):</p>
                        <div class="wrapper">
                            <img id="ExistingSignature">
                            <canvas id="signature-pad" class="signature-pad" width=500 height=100></canvas>
                        </div><br>
                        <button type="button" class="btn btn-secondary" onclick="ClearSignaturePad()">Pulisci</button>
                        <button type="button" class="btn btn-secondary" onclick="SaveSignature()">Salva</button>
                        <input type="file" id="ImportExistingSignature" name="ImportExistingSignature" hidden
                            style="position: absolute; display: none;" />
                    </div>
                </div><br>

                <h3>Inserisci</h3>
                <br>
                <form id="receiptsForm" action="post">
                    <div class="row">
                        <div class="col-2">
                            <label for="prezzo">Nr: </label>
                            <input type="text" class="form-control" placeholder="Nr." name="LastNo" autocomplete="off">
                        </div>
                        <div class="col-3">
                            <label for="Date">Data: </label>
                            <input type="text" class="form-control" id="datepicker" placeholder="Data" name="Date"
                                autocomplete="off" required>
                        </div>
                        <div class="col-7">
                            <label for="Holder">Intestatario: </label>
                            <input type="text" class="form-control" placeholder="Intestatario" name="Holder"
                                autocomplete="off" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="Reason">Causale: </label>
                            <input type="text" class="form-control" placeholder="Causale" name="Reason"
                                autocomplete="off" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="Price">Prezzo (in lettere): </label>
                            <input type="text" class="form-control" placeholder="Prezzo" name="Price" autocomplete="off"
                                required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="Total">Totale (in cifre): </label>
                            <input type="number" class="form-control" placeholder="Totale" name="Total"
                                autocomplete="off" required step="any">
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col">
                            <input type="submit" class="btn btn-success" value="Salva">
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-md-6 mt-2">

                <div id="out_image" hidden>
                    <h4>Ricevute:</h4>
                    <br>
                    <div id="Links"></div>
                </div>
            </div>
        </div>
        <br>
        <hr>
        <h4>Dati</h4>
        <div id="toolbar">
            <button type="button" class="btn btn-secondary" id="printReceipts">Stampa Ricevute</button>
            <button type="button" class="btn btn-secondary" id="CopyExcel">Copia per Excel</button>
        </div>
        <table id="receiptsTbl" data-toolbar="#toolbar">
            <thead>
                <tr>
                    <th data-field="No" data-editable="true">Nr.</th>
                    <th data-field="Date" data-editable="true">Data</th>
                    <th data-field="Holder" data-editable="true">Intestatario</th>
                    <th data-field="Price" data-editable="true">Prezzo</th>
                    <th data-field="Reason" data-editable="true">Causale</th>
                    <th data-field="Total" data-editable="true">Totale</th>
                </tr>
            </thead>
        </table>

        <br>

        <br>
        <div id="template" style="display: none;">
            <div class="Content" data-id="{{No}}">
                <div class="receiptContainer">
                    <div class="row">
                        <div class="col">
                            <img src="Images/Cngei_Sezioni48.png" width="100" height="100"
                                crossorigin="use-credentials">
                        </div>
                        <div class="col allRight ">
                            <div class="allInLine">
                                <h3>RICEVUTA</h3>
                                <h4>n.</h4>
                                <div class="bottomline-small value">{{No}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="linebreak"></div>
                    </div>
                    <div class="row mt-3">
                        <div class="col withBottomLine">
                            <h4>Ricevuti da:</h4>
                            <div class="bottomline-full value">{{Holder}}</div>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col withBottomLine">
                            <h4>Data:</h4>
                            <div class="bottomline-full value">{{Date}}</div>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col withBottomLine">
                            <h4>€:</h4>
                            <div class="bottomline-full value">{{Price}}</div>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col withBottomLine">
                            <h4>Causale:</h4>
                            <div class="bottomline-full value">{{Reason}}</div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col withBottomLine">
                            <h4>Firma:</h4>
                            <img id="ReceiptSignature" />
                        </div>
                        <div class="col withBottomLine">
                            <h3>TOTALE:</h3>
                            <div class="bottomline-full value">{{Total}}</div>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <p class="bollo">Esente da bollo ai sensi dell'art. 82 co.5 D Lgs 117/2017</p>
                    </div>
                </div>
                <br>
            </div>
        </div>
    </div>



    <div id="all"></div>

    <script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
    <script src="JS/dom-to-image.min.js"></script>
    <script src="JS/script.js"></script>
</body>

</html>